<!-- ---
title : Cuisine Classifier 
layout : page
--- -->

---
title : Home
layout: page
---

<input id="photo" type="file">
<div id="results"></div>
<script>
    async function loaded(reader) {   
    const response = await fetch("https://soothsayer1221-cuisine-classifier.hf.space/call/predict", {
        method: "POST", headers: { "Content-Type": "application/json" },
        body: JSON.stringify({data: [reader.result]})});
    const json = await response.json();
    const label = json['data'][0]['label'];
    results.innerHTML = `<br/> <img src = "${reader.result}" width="500"> <p>${label}</p>`;
    }
    function read() {
        const reader = new FileReader();
        reader.addEventListener('load', () => loaded(reader))
        reader.readAsDataURL(photo.files[0]);
    }
    photo.addEventListener('input', read);
</script>


<!-- <input id="photo" type="file" accept="image/*">
<div id="image-container">
  <h3>Uploaded Image:</h3>
  <img id="uploadedImage" alt="Your uploaded image will appear here" width="300">
</div>
<div id="results"></div> 

<script>
  async function loaded(reader) {   
    const response = await fetch("https://soothsayer1221-cuisine-classifier.hf.space/call/predict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ data: [reader.result] })
    });
    
    const json = await response.json();
    console.log(json); 
    
    // Check if data exists in the response
    if (json.data && json.data[0] && json.data[0].label) {
        const label = json['data'][0]['label'];
        results.innerHTML = `<br/> <img src="${reader.result}" width="500"> <p>${label}</p>`;
    } else {
        results.innerHTML = "<p>Error: Could not retrieve label</p>";
    }
}

</script> -->

<!-- <script>
  async function loaded(reader) {   
  const response = await fetch("https://soothsayer1221-cuisine-classifier.hf.space/call/predict", {
      method: "POST", headers: { "Content-Type": "application/json" },
      body: JSON.stringify({data: [reader.result]})});
  const json = await response.json();
  const label = json['data'][0]['label'];
  results.innerHTML = `<br/> <img src = "${reader.result}" width="500"> <p>${label}</p>`;
  }
  function read() {
      const reader = new FileReader();
      reader.addEventListener('load', () => loaded(reader))
      reader.readAsDataURL(photo.files[0]);
  }
  photo.addEventListener('input', read);
</script> -->
<!-- 
<script type="module">
  document.getElementById('photo').addEventListener('change', async function (event) {
    const file = event.target.files[0];
    
    if (file) {
      // Display the uploaded image
      const imgElement = document.getElementById('uploadedImage');
      imgElement.src = URL.createObjectURL(file);

      // Read the image file as a blob
      const reader = new FileReader();
      reader.readAsArrayBuffer(file);
      reader.onloadend = async function () {
        const blob = new Blob([reader.result], { type: file.type });

        try {
          // Initialize Gradio Client
          const client = await Client.connect("soothsayer1221/cuisine_classifier");

          // Send the uploaded image for prediction
          const result = await client.predict("/predict", { 
              image: blob
          });

          // Display the prediction result
          document.getElementById('results').innerHTML = `<h3>Prediction: ${result.data}</h3>`;
        } catch (error) {
          console.error("Error in prediction:", error);
          document.getElementById('results').textContent = "Error in prediction.";
        }
      };
    }
  });
</script> -->

